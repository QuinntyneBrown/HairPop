@startuml Data Flow

title HairPop - Data Flow Diagram

skinparam backgroundColor #FEFEFE
skinparam defaultFontName Arial
skinparam activityShape octagon

start

:Customer opens HairPop app;

partition "Frontend Layer" {
    :Angular SPA loads;
    :Request braiders data;
}

partition "API Gateway" {
    :Receive HTTP request;
    :Apply CORS policy;
    :Route to microservice;
}

partition "Braiders Microservice" {
    :BraidersController receives request;
    :MediatR dispatches to handler;

    if (Validation required?) then (yes)
        :FluentValidation validates request;
        if (Valid?) then (yes)
            :Continue processing;
        else (no)
            :Return 400 Bad Request;
            stop
        endif
    else (no)
        :Continue processing;
    endif

    :Handler processes request;
    :DbContext queries database;
}

partition "Database Layer" {
    :Execute SQL query;
    :Return result set;
}

partition "Response Flow" {
    :Map entities to DTOs;
    :Create response object;
    :Return JSON response;
}

partition "Frontend Update" {
    :Receive API response;
    :Update component state;
    :Render updated view;
}

:Customer views braiders;

stop

@enduml
